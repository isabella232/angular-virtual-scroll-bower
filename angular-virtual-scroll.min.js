/* angular-virtual-scroll - v0.6.2 - 2015-08-31 */ !function(){"use strict";angular.module("sf.virtualScroll",[]).constant("sfVirtualScroll",{release:"0.6.2",version:"0.6.1-27-gd077904"})}(),function(){"use strict";var a=angular.module("sf.virtualScroll");a.filter("sublist",function(){return function(a,b,c){return a.slice(c,c+b)}})}(),function(){"use strict";var a=angular.module("sf.virtualScroll");a.directive("sfScroller",function(){function a(a){var b=a.match(/^(x|y)\s*(=|in)\s*(.+) to (.+)$/);if(!b)throw new Error("Expected sfScroller in form of '_axis_ in _lower_ to _upper_' but got '"+a+"'.");return{axis:b[1],lower:b[3],upper:b[4]}}var b=18;return function(c,d,e){var f=a(e.sfScroller),g=c.$eval(f.lower),h=c.$eval(f.upper),i="x"===f.axis;d.css({height:i?"1em":"100%",width:i?"100%":"1em","overflow-x":i?"scroll":"hidden","overflow-y":i?"hidden":"scroll",position:"absolute",top:i?"100%":0,right:0}).parent().css({position:"relative"});var j=angular.element("<div></div>");d.append(j),d.bind("scroll",function(){var a=d.prop("scrollTop");e.ngModel&&c.$apply(e.ngModel+" = "+a/b)}),c.$watch(f.lower,function(a){g=a,j.css("height",(h-g)*b+"px")}),c.$watch(f.upper,function(a){h=a,j.css("height",(h-g)*b+"px")}),c.$watch(e.ngModel,function(a){var c=a*b;d.prop("scrollTop")!==c&&d.prop("scrollTop".scrollTop)})}})}(),function(){"use strict";function a(b,c,d){return angular.isArray(b)?angular.forEach(b,function(b){return a(b,c,d)}):Math.max(c,Math.min(b,d))}var b=angular.module("sf.virtualScroll"),c=["TABLE","TBODY","THEAD","TR","TFOOT"],d=["TABLE","TBODY","THEAD","TR","TFOOT"],e=["TABLE","TBODY","THEAD","TR","TFOOT"];b.directive("sfVirtualRepeat",["$rootElement",function(b){function f(a){var b=a.match(/^\s*([\$\w]+)\s+in\s+([\S\s]*)$/);if(!b)throw new Error("Expected sfVirtualRepeat in form of '_item_ in _collection_' but got '"+a+"'.");return{value:b[1],collection:b[2]}}function g(a,b){var c,d=a.tagName.toUpperCase();for(c=0;c<b.length;c++)if(b[c]===d)return!0;return!1}function h(a){var e,f,h=b[0];for(e=a.parent().parent()[0];e!==h&&1==e.nodeType;e=e.parentNode)if(!g(e,c)&&1==e.childElementCount&&!g(e.firstElementChild,d)){for(f=e.firstChild;f&&(3!=f.nodeType||!/\S/g.test(f.textContent));f=f.nextSibling);if(null==f)return{viewport:angular.element(e),content:angular.element(e.firstElementChild)}}throw new Error("No suitable viewport element")}function i(a){var b={overflow:"auto"},c=window.getComputedStyle?window.getComputedStyle(a[0]):a[0].currentStyle,d=c&&c.getPropertyValue("max-height"),e=c&&c.getPropertyValue("height");d&&"0px"!==d?b.maxHeight=d:e&&"0px"!==e?b.height=e:b.height=window.innerHeight,a.css(b)}function j(a){var b={margin:0,padding:0,border:0,"box-sizing":"border-box"};a.css(b)}function k(a){var b=window.getComputedStyle?window.getComputedStyle(a):a.currentStyle,c=b&&b.getPropertyValue("max-height"),d=b&&b.getPropertyValue("height");return c&&"0px"!==c&&"none"!==c?d=c:a.clientHeight&&(d=a.clientHeight+"px"),angular.element(a).css("height",d),parseInt(d,10)}function l(b,c,d){function l(b,c,f){function l(a){var b={margin:"0"};g(a[0],e)||(b.display="block"),v&&(b.height=v+"px"),a.css(b)}function n(a,b,c){var d=c.$new(),e=c.$eval(b);return d[m.value]=e[a],d.$index=a,d.$first=0===a,d.$last=a===e.length-1,d.$middle=!(d.$first||d.$last),d.$watch(function(){e=c.$eval(b),d[m.value]=e[a]}),d}function o(a,b,c,e,f){var g,h,i,j=document.createDocumentFragment(),k=[];for(h=a;h!==b;h++)i=n(h,c,e),g=d(i,angular.noop),l(g),k.push(g),j.appendChild(g[0]);return f.after(j),k}function p(){var b=a(z.firstActive,z.firstVisible-z.lowWater,z.firstVisible-z.highWater),c=a(z.firstActive+z.active,z.firstVisible+z.visible+z.lowWater,z.firstVisible+z.visible+z.highWater);z.firstActive=a(b,0,z.total-z.visible-z.lowWater),z.active=Math.min(c,z.total)-z.firstActive}function q(a){if(v){var c=a.target.scrollTop,d=(a.target.scrollHeight,a.target.clientHeight,Math.abs(c-A));if(d>z.threshold*v){z.firstVisible=Math.floor(c/v),z.visible=Math.ceil(y.viewport[0].clientHeight/v);p(),b.digest(),A=c}}}function r(a){var b=a.$eval(m.collection);return b&&b.length!==z.total&&(z.total=b.length,p()),{start:z.firstActive,active:z.active,len:b?b.length:0}}function s(a,b){var c,d,e=Array.prototype[a];for(d=0;b>d;d++)c=e.call(u),c.scope().$destroy(),c.remove()}function t(a,b,d){var e,f=b.start+b.active;if(a===b)e=o(a.start,f,m.collection,d,c),u=e,u.length&&(v=k(e[0][0]));else{var g=a.start+a.active,h=a.start>=b.start,i=h?a.start-b.start:b.start-a.start,j=g>=f?g-f:f-g,l=i<(h?b.active:a.active);if(l){if(h?s("shift",i):i&&(e=o(a.start,b.start,m.collection,d,c),u=e.concat(u)),f>g)s("pop",f-g);else if(j){var n=u[u.length-1];e=o(f,g,m.collection,d,n),u=u.concat(e)}}else s("pop",u.length),u=o(a.start,g,m.collection,d,c);!v&&u.length&&(v=k(u[0][0])),y.content.css({"padding-top":a.start*v+"px"})}y.content.css({height:a.len*v+"px"}),w&&x&&(y.viewport[0].scrollTop=y.viewport[0].clientHeight+y.viewport[0].scrollHeight)}var u=[],v=0,w=!1,x="sticky"in f,y=h(c),z="ngModel"in f?b.$eval(f.ngModel):{};z.firstActive=0,z.firstVisible=0,z.visible=0,z.active=0,z.total=0,z.lowWater=z.lowWater||100,z.highWater=z.highWater||300,z.threshold=z.threshold||1;var A=0;j(y.content),i(y.viewport),y.viewport.bind("scroll",q),b.$watch(r,t,!0)}var m=f(c.sfVirtualRepeat);return{post:l}}return{require:"?ngModel",transclude:"element",priority:1e3,terminal:!0,compile:l}}])}();